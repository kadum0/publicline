<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>publicline</title>

    <!-- leaflet cdn -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>


    <link rel="shortcut icon" type="image/jpg"
        href="https://kadum2.github.io/publicline/home/imgs/publicline-logo.png" />
    <!-- <link rel="stylesheet" href="./style.css"> -->
    <!-- <link rel="manifest" href="./manifest.json"> -->


    <!-- font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prosto+One&family=Changa:wght@300&display=swap"
        rel="stylesheet">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Prosto+One&family=Changa:wght@300&display=swap');
    </style>

    <style>
        /* basic */
        /* header */

        header {
            height: 3rem;
            background-image: linear-gradient(135deg, #1a1a1a, #333333);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
            border-bottom: #27f060 2px solid;
            position: relative;
        }

        .links {
            display: flex;
            /* padding: 1rem; */
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            position: relative;
        }

        .logo div {
            height: 25%;
            width: 65%;
            margin-bottom: 10%;
            transform: rotateZ(-15deg);
        }

        .logo,
        .projectLink,
        #asideDi {
            height: 3rem;
            width: 3rem;
        }

        #asideDi {
            padding: .7rem;
            z-index: 1004;
            /* background: #303832; */
            /* background-color: #333333; */
            border-radius: .3rem;
            transition: .1s linear;
            cursor: pointer;
        }

        .projectLink img,
        #asideDi img {
            height: 100%;
            width: 100%;
            object-fit: contain;
        }

        #miniProfile {
            position: absolute;
            padding: 1rem;
            top: 3rem;
            right: 1rem;

            display: none;

            background: rgba(149, 255, 193, 0.2);
            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(5px);

            background-image: linear-gradient(135deg, #f0f0f0, #ffffff);


            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);

            z-index: 1005;
        }

        #miniProfileDi div {
            pointer-events: none;
            /* padding: .2rem; */
        }

        #miniProfileDi {
            padding: .1rem;
        }

        #miniProfileDi img {
            height: 2rem;
            width: 2rem;
            border-radius: 50%;
        }

        .logged,
        .notlogged,
        .halfLogged {
            display: none;
        }

        /* not logged */
        #register,
        #signin {
            /* background: #22c7519a; */
            background: #22c751;
            background: #68F690;
            background-image: linear-gradient(135deg, #68F690, #22c751);

            border-radius: .5rem;
        }

        /* logged */
        #currentAccount {
            text-decoration: none;
            color: black;
        }

        #currentAccountImgDi {
            background-position: center;
            background-size: cover;
        }


        .currentAccount .accountImg {
            height: 3rem;
            width: 3rem;
            background-size: cover;
            background-position: center;
            border-radius: 50%;
        }

        #byGoogle {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* half logged */


        #redArrow {
            display: none;
            position: absolute;
            top: 1rem;
            /* left: 3.5rem; */
            left: 4rem;
            transform: rotateZ(-140deg);
            z-index: 1010;
            height: 7rem;
            width: 7rem;
            transition: opacity 3s;
        }



        /* main */
        main {
            overflow: hidden;
        }

        #map {
            height: 92vh;
            width: 100vw;
        }

        #addRouteMode {
            border: #1F2721 2px solid;
            z-index: 1003;
            /* background: red; */
            /* background-image: url('./home/imgs/addroute-form.png'); */
            background-repeat: no-repeat;
            font-size: 1.3rem;
            font-weight: bold;
        }

        #send {
            /* margin-top: 2rem; */
            background: #1bf057;
            border: 4px #1F2721 solid;
        }

        #send:hover {
            color: #1bf057;
            background: #1F2721;
        }

        .deletebtns {
            /* padding: .5rem; */
            border: 2px dashed black;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .deletebtns button {
            display: block;
            /* margin: .2rem; */
        }

        /* controllers */
        #controller {
            display: flex;
            flex-direction: column;
            width: 6rem;
            gap: .4rem;
            font-size: 2.4rem;
            font-weight: bold;
            position: absolute;
            top: 50%;
            right: .1rem;
            z-index: 1003;
            background: #303832;
            border-radius: .5rem;
            background: rgba(255, 255, 255, 0.2);
            background: rgba(149, 255, 193, 0.2);

            border-radius: 16px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        #controller button {
            font-weight: bold;
        }

        #newRouteDetails {
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: .2rem;
            /* display: none; */
        }

        #selectGovernate {
            position: absolute;
            top: 5.5rem;
            z-index: 1003;
        }

        #basraLogo {
            background-image: url('./home/imgs/basra-logo.png');
            background-position: left center;
            background-repeat: no-repeat;
        }

        select#selectGovernate option[value="basra"] {
            height: 1rem;
            width: 1rem;
            background-image: url('./home/imgs/basra-logo.png');
        }




        #makeLocLink {
            position: absolute;
            top: 7rem;
            left: .1rem;
            z-index: 1003;
        }


        #messages {
            /* position: absolute; */
            position: fixed;
            top: 5rem;
            right: 50vw;
            text-align: center;
            z-index: 1005;
        }

        #messages div {
            display: none;
        }



        #routesToDisplay {
            z-index: 1003;
            position: absolute;
            top: 3.2rem;
            left: .1rem;
            font-weight: bold;
            /* color: #0171da; */
        }

        #routesToDisplay button {
            /* border: ; */
            border: #2b2b2b 1px solid;
            border-radius: .3rem;
        }

        #findMe {
            position: absolute;
            bottom: 3rem;
            left: .1rem;
            z-index: 1003;
            border-radius: 50%;
            padding: .1rem;
        }


        /* aside */
        aside {
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;

            position: absolute;
            background: #1a1a1a8c;
            background-image: linear-gradient(180deg, #33333362, #088f2a70);

            top: 0;
            /* height: 100vh; */
            width: 100vw;
            margin-top: 3rem;
            gap: 1rem;

            z-index: 1003;
        }




        /* leaderboard */
        .leaderBoard {
            margin-top: 5rem;
            position: relative;
            display: flex;
            flex-direction: column;
            width: 70%;
            padding: 1rem;
            max-height: 65vh;
            /* overflow-y: scroll; */
            background: #242424;
            background-image: linear-gradient(135deg, #1a1a1a, #2b2b2b);

            border: #27f060 1px solid;
            max-height: 70vh;
            /* box-sizing: border-box; */
            overflow: scroll;
        }

        .leaderBoard button {
            background-repeat: no-repeat;
        }

        #leaderBoardImg {
            position: absolute;
            top: -1rem;
            right: -1rem;
            height: 11rem;
            width: 13rem;
            z-index: 1010;
        }

        .rankingSections button {
            background: #33a353;
            padding: .2rem;
            cursor: pointer;
            border-radius: .2rem;
            /* width: fit-content; */
        }

        .rankingHeader {
            display: flex;
            flex-direction: row;
            background: #0a0a0a;
            justify-content: space-between;
        }

        .rankingHeader img {
            min-height: 3rem;
            min-width: 3rem;
        }

        .rankingHeader button {
            padding: 1rem;
            width: 100%;
            width: fit-content;
        }

        .rankedAccount {
            border: #0a0a0a 2px solid;
            display: flex;
            justify-content: space-between;
            color: white;
            /* background: #242424; */
            background-image: linear-gradient(135deg, #1a1a1a, #2b2b2b);

            gap: 1rem;
            max-width: 100%;
            box-sizing: border-box;
        }

        .rankedAccount .account {
            color: white;
        }

        .points {
            display: flex;
            width: 7rem;
            justify-content: space-between;

        }

        .point {
            text-align: center;
            font-size: 2rem;
        }

        .ranking {
            display: flex;
            flex-direction: column;
            background: #29D659;
            border: #a0f7b9 2px solid;
            padding: .3rem;
        }

        .rankedAccount .accountImg {
            min-height: 2rem;
            min-width: 2rem;
        }

        .rankedAccount h3 {
            line-height: 0;
        }

        .rankedAccount .account:hover {
            background: #3ac962;
        }


        #shordDescription {
            margin: 5rem;
            font-weight: bold;
            padding: 1rem;
        }



        /* footer */
        footer {
            min-height: 20vh;
            background-image: linear-gradient(45deg, #1a1a1a, #292929);

            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            border-top: #27f060 2px solid;
            gap: 3rem;
            width: 100%;
            padding: 3rem;
        }


        .sindibadIcons {
            height: 6rem;
            width: 6rem;
            position: absolute;
            bottom: -3rem;
            left: -1rem;
            z-index: 3;
        }

        .contact,
        .statics,
        .features {
            display: flex;
            justify-content: space-around;
            flex-direction: column;
            align-items: center;
            min-height: 15vh;
            border-radius: .5rem;
            transition: .1s linear;
            background: white;
            padding: 1rem;
            position: relative;
        }

        .contact:hover,
        .features:hover,
        .statics:hover {
            box-shadow: 3px 3px 0px 0px #29D659;
        }

        .logoPart {
            /* background: red; */
            height: 1rem;
            width: 2rem;
            margin-top: 1rem;
            transform: rotateZ(-15deg);
            z-index: 1001;
        }

        .features li img {
            all: unset;
            height: 3rem;
            /* width: 3rem; */
        }


        .projectsInfo {
            display: flex;
            width: 100%;
            justify-content: space-around;
            gap: .3rem;
        }

        .projectStatics {
            background: #54db7b;
            background-image: linear-gradient(135deg, #6ada89, #3ac962);
            /* background: red; */
            border-radius: .3rem;
            padding: .3rem;
            display: flex;
            flex-direction: column;
            gap: .3rem;
        }

        .statics li b {
            color: red;
        }

        .statics img {
            /* height: 1rem; */
        }

        .statics li {
            background: #C0F9D0;
            background-image: linear-gradient(135deg, #9cffb8, #54ff85);

            border-radius: .4rem;
            margin-bottom: .2rem;
        }


        .features {
            width: fit-content;
        }

        .features img {
            /* height: 1rem; */
        }

        .features li b {
            color: red;
        }

        .features li {
            direction: rtl;
            background: #1a1a1a;
            color: white;
            margin: .1rem;
            padding: .3rem;
            border-radius: .3rem;
            list-style-type: none;

        }

        /* .features{
    width: 50vw;
}
.features div{
    background: #1a1a1a;
    color: white;
    margin: .1rem;
} */



        /* elements */
        body {
            margin: 0;
            overflow-x: hidden;
        }

        main div,
        main p,
        main h1,
        main h2,
        main h3,
        main h4,
        main h5,
        main h6 {
            direction: rtl;
        }

        body * {
            box-sizing: border-box;
            font-family: 'Prosto One', 'Changa';
            font-size: .8rem;
        }

        img {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            height: 2rem;
            pointer-events: none;
        }

        input[type=text] {
            font-size: 1rem;
        }

        input[type=file] {
            display: none;
        }

        a {
            text-decoration: none;
            color: black;
            display: inline-block;

        }

        button {
            background-position: center;
            background-size: contain;
        }


        ::-webkit-scrollbar {
            width: 6px;
            border-left: 1px solid #292929;
        }

        ::-webkit-scrollbar-thumb {
            background-color: #33a353;
        }




        /* shared */
        .logged,
        .makeprofile,
        .notlogged {
            display: none;
        }

        .team {
            display: none;
        }

        .en {
            display: none;
            pointer-events: none;
        }

        .ar {
            pointer-events: none;
        }

        .box {
            background-color: #27f060;
            /* background-image: linear-gradient(135deg,  #27f060, #22c751); */
            background-image: linear-gradient(135deg, #27F060, #21C24F);

            padding: .5rem;
            border-radius: .5rem;
            transition: .1s linear;
            cursor: pointer;
        }

        .bbox {
            /* background-color: #27f060; */
            /* background-image: linear-gradient(135deg,  #27f060, #22c751); */
            /* background-image: linear-gradient(135deg,  #000000,  #161616); */
            background-image: linear-gradient(135deg, #1a1a1a, #333333);


            padding: .5rem;
            border-radius: .5rem;
            transition: .1s linear;
            cursor: pointer;
        }

        .box img {
            /* height: 100%; */
        }

        .box:hover {
            background-color: #33a353;
            border-radius: .7rem;
        }

        .bbox:hover {
            background-color: #464646;
            background-image: linear-gradient(135deg, #141414, #2e2e2e);

            border-radius: .7rem;
        }

        .flex {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .account {
            display: flex;
            flex-direction: row;
            gap: .6rem;
            justify-content: center;
            align-items: center;
            transition: .1s linear;
            cursor: pointer;
        }

        .accountImg {
            border-radius: 50%;
            border: #0a0a0a 1px solid;
        }

        .on {
            background: #1b1b1b;
            color: white;
        }

        .on:hover {
            background: #333333;
        }

        .on2 {
            /* background: #1bf057; */
            background-image: linear-gradient(135deg, #27F060, #21C24F);

        }

        .red {
            background: #ff2a2a;
            background-image: linear-gradient(135deg, #ED2121, #CD1A1A);
        }

        .green {
            background: #27f060;
            background-image: linear-gradient(135deg, #27F060, #21C24F);
        }

        .black {
            background: #1b1b1b;
            background-image: linear-gradient(135deg, #1A1A1A, #0E0E0E);
        }

        .white {
            background: rgb(245, 245, 245);
            background-image: linear-gradient(135deg, #F5F5F5, #DEDEDE);
        }

        /* mobile */

        @media all and (max-width: 500px) {
            header {
                gap: .3rem;
            }

            .links {
                gap: .3rem;
            }

            .links a,
            .links button {
                height: 2rem;
                width: 2rem;
            }

            #miniProfile {
                margin: 2rem;
            }

            main {
                flex-direction: column;
            }

            body * {
                font-size: .8rem;
            }

            footer {
                flex-direction: column;
                /* gap: .2rem; */
            }

            .contact,
            .features,
            .statics {
                width: 90vw;
            }

            /* leaderboard */
            .leaderBoard {
                width: 90vw;
            }

            .rankingHeader {
                /* height: 2rem; */
            }

            .rankingHeader button:first-child {
                /* padding: auto; */
                /* width: auto; */
                /* line-height: 0; */
            }

            .box,
            .bbox {
                padding: .2rem;
            }

            #leaderBoardImg {
                /* top: 27rem; */
                /* right: 0rem; */
                height: 7rem;
                width: 9rem;
            }

            #shordDescription {
                margin: 1rem;
                font-weight: bold;
                padding: .5rem;
            }

            #redArrow {
                left: 3.5rem;
            }
        }


        /* js created */

        .upvoteBtn,
        .downvoteBtn {
            margin-right: 2px;
            margin-bottom: 2px;
            border: none;
            border-radius: .6rem;
            cursor: pointer;
            transition: .1s linear;
            display: inline;
            padding: .4rem;
        }

        .upvoteBtn {
            background: #1bf057;
            border: 2px solid #1bf057;
        }

        .upvoteBtn:hover {
            background: #29D659;
        }

        .downvoteBtn {
            background: #ff2a2a;
            border: 2px solid #ff2a2a;

        }

        .downvoteBtn:hover {
            background: #df2727;
        }

        .voted {
            border: 2px solid blue;
        }

        .sureBtn {
            background: rgb(48, 154, 253);
            border: none;
            border-radius: .6rem;
            transition: .1s linear;
            padding: .6rem;
            width: 100%;
            cursor: pointer;
        }

        .sureBtn:hover {
            background: rgb(34, 106, 173);
        }


        .leaflet-control-geocoder-icon {
            z-index: 1020;
        }
    </style>
</head>

<body>


    <header>
        <!-- logo -->
        <div class="links">
            <!-- 
            <a href="https://kadum2.github.io/git4t" class="logo box">
                <div class="black"></div>
                <div class="red"></div>
                <div class="white"></div>
            </a>
        -->

            <a href="https://kadum2.github.io/publicline/home" class="box projectLink">
                <img src="./home/imgs/publicline-logo.png" alt="">
            </a>

            <button id="asideDi" class="box">
                <img src="./home/imgs/general/q-icon.png" alt="">
            </button>

            <!-- <button class="box" id="translateToEn">en</button> -->

            <img src="./home/imgs/general/arrow-right.png" id="redArrow">

        </div>

        <!-- title -->
        <h2 id="projectName" class="box">
            <div class="en">publicline</div>
            <div class="ar">الخط العام</div>
        </h2>

        <!-- auth; auth-di, auth-state -->
        <div id="miniProfileDi" class="box">
            <div class="logged" style="height: fit-content;">
                <div class="flex currentAccount">
                    <img id="currentAccountImgDi">
                    <p id="currentAccountUsernameDi">username</p>
                    <p class="team" style="line-height: none; padding:0;
            color:white; font-size: .8rem;">team</p>
                </div>
            </div>

            <div class="notlogged">
                <div class="ar">انشأ حساب</div>
                <div class="en">create account</div>
            </div>
            <div class="halfLogged">
                <div class="ar">اكمل البيانات</div>
                <div class="en">fill the rest info</div>
            </div>
        </div>

        <div id="miniProfile">

            <div class="logged">
                <div class="ar">حسابك</div>
                <div class="en">your account</div>
                <!-- <p>حسابك </p> -->
                <!-- account link? -->
                <a class="flex box currentAccount" id="currentAccountLink" href="">
                    <img id="currentAccountImgMini">
                    <p id="currentAccountUsernameMini" style="line-height: 0;">username</p>
                </a>
                <b>
                    <p id="currentAccountName"></p>
                </b>
                <p id="currentAccountBio">bio</p>
                <button class="box" id="signoutBtn" style="display: inline;">logout</button>
            </div>
            <div class="halfLogged">
                <div class="ar">انت الان مسجل: يجب اكمال البيانات لانشاء
                    حساب</div>
                <div class="en">your are now logged; you have to complete
                    inserting the rest info</div>
                <!-- <p>انت الان مسجل: يجب اكمال البيانات لانشاء حساب </p> -->
                <input type="text" id="username" placeholder="username">
                <input type="text" id="name" placeholder="name">
                <input type="text" id="bio" placeholder="bio">
                <label for="userImg" id="userImgUpload" class="box">upload image</label>
                <input type="file" id="userImg">
                <button id="makeProfileBtn" class="box">
                    <div class="ar">ارسال</div>
                    <div class="en">send</div>
                </button>

                <button id="halfLoggedSignoutBtn" class="box">logout</button>

            </div>

            <div class="notLogged">
                <div class="ar">غير مسجل</div>
                <div class="en">not registered</div>
                <!-- <p>تسجيل الدخول: </p> -->
                <div id="register">
                    <div class="ar">تسجيل لاول مرة</div>
                    <div class="en">register</div>

                    <input type="text" class="em" placeholder="em">
                    <input type="text" class="pw" placeholder="pw">
                    <button id="registerBtn" class="box">register</button>
                </div>
                <br>
                <div id="signin">
                    <div class="ar">تسجيل الدخول</div>
                    <div class="en">sign in</div>

                    <input type="text" class="em" placeholder="em" id="signinUsername">
                    <input type="text" class="pw" placeholder="pw" id="signinUsername">
                    <button id="signinBtn" class="box">signin</button>
                </div>
                <h3>or</h3>
                <button id="byGoogle" class="box">register with google <img src="./home/imgs/general/google-logo.png"
                        alt="">
                </button>
            </div>

        </div>

    </header>

    <main>
        <div id="map"></div>

        <!-- collect data; controllers -->
        <div id="controller">

            <button class="bbox" id="addRouteMode" style="background-image:
            url('./home/imgs/add-route-icon.png');background-color:#1a1a1a; color:
            white">

                <!-- <button class="bbox" id="addRouteMode" style="background-image: linear-gradient(to right, #0000FF, #00FF00), url('./home/imgs/blue-glowing-pin.png'); color: -->
                <!-- white"> -->

                +

                <!-- background-image: linear-gradient(to right, #0000FF, #00FF00), url(your-background-image-url.jpg); -->

                <!-- <img src="./home/imgs/add-route-icon.png" alt=""> -->
            </button>

            <div id="newRouteDetails">
                <input type="text" name="" id="routeName" placeholder="اسم المسار">
                <div class="deletebtns">
                    <button class="box" id="cancel-step">
                        <div class="en">cancel step</div>
                        <div class="ar">الغاء الخطوة </div>
                    </button>
                    <!-- <button class="box" id="cancel-route">الغاء المسار</button> -->
                </div>
                <button class="box" id="start">
                    <div class="en">start point</div>
                    <div class="ar">نقطة البدية</div>
                </button>
                <button class="box" id="end">
                    <div class="en">end point</div>
                    <div class="ar">نقطة النهاية</div>
                </button>

                <button class="box" id="send">
                    <div class="en">send</div>
                    <div class="ar">ارسال</div>
                </button>
            </div>
        </div>

        <div id="routesToDisplay">
            <button id="displayConfirmedRoutes">
                <div class="ar">مؤكدة</div>
                <div class="en">confirmed</div>
            </button>
            <button id="displayCompletedRoutes">
                <div class="ar">كاملة</div>
                <div class="en">completed</div>
            </button>
            <button id="displayUncompletedRoutes">
                <div class="ar">غير كاملة</div>
                <div class="en">not completed</div>
            </button>
        </div>

        <select id="selectGovernate">
            <!-- main -->
            <option value="">
                governate-المحافظة
            </option>
            <option value="baghdad">
                <p class="en">baghdad</p>
                <div class="ar">بغداد</div>
            </option>

            <option value="basra">
                <div class="en">basra</div>
                <div class="ar">بصرة</div>
            </option>

            <option value="nineveh">
                <div class="en">nineveh</div>
                <div class="ar">نينوى</div>
            </option>
            <option value="dhi-qar">
                <div class="en">dhi-qar</div>
                <div class="ar">ذي قار</div>
            </option>
            <option value="babil">
                <div class="en">babil</div>
                <div class="ar">بابل</div>
            </option>
            <option value="sulaymaniyah">
                <div class="en">sulaymaniyah</div>
                <div class="ar">سليمانية</div>
            </option>
            <option value="erbil">
                <div class="en">erbil</div>
                <div class="ar">اربيل</div>
            </option>
            <option value="anbar">
                <div class="en">anbar</div>
                <div class="ar">انبار</div>
            </option>

            <option value="karbala">
                <div class="en">karbala</div>
                <div class="ar">كربلاء</div>
            </option>
            <option value="najaf">
                <div class="en">najaf</div>
                <div class="ar">نجف</div>
            </option>

            <!--  -->

            <option value="dohuk">
                <div class="en">dohuk</div>
                <div class="ar">دهوك</div>
            </option>
            <option value="kirkuk">
                <div class="en">kirkuk</div>
                <div class="ar">كركوك</div>
            </option>
            <option value="saladin">
                <div class="en">saladin</div>
                <div class="ar">صلاح الدين</div>
            </option>
            <option value="diyala">
                <div class="en">diyala</div>
                <div class="ar">ديالى</div>
            </option>
            <option value="wasit">
                <div class="en">wasit</div>
                <div class="ar">واسط</div>
            </option>
            <option value="al-qadisiyyah">
                <div class="en">al-qadisiyyah</div>
                <div class="ar">القادسية</div>
            </option>
            <option value="maysan">
                <div class="en">maysan</div>
                <div class="ar">ميسان</div>
            </option>
            <option value="muthanna">
                <div class="en">muthanna</div>
                <div class="ar">مثنى</div>
            </option>
            <option value="halabja">
                <div class="en">halabja</div>
                <div class="ar">حلبجة</div>
            </option>



        </select>

        <button id="makeLocLink" class="bbox"><img src="./home/imgs/green-glowing-pin.png" style="pointer-events:
        none;"></button>

        <button id="findMe" class="box"><img src="./home/imgs/general/aim-icon.png"></button>

        <div id="messages">
            <div id="greenMessage" class="box green">
                <img src="./home/imgs/general/loading.gif" style="width: fit-content;">
            </div>

            <div id="copyMessage" class="box green">
                link copied
            </div>

            <div id="redMessage" class="box red">error, no valid data, full the rest</div>
        </div>

    </main>

    <aside>

        <!-- temp -->
        <div class="features" id="features" style="width: 80%;">
            <div class="black logoPart"></div>

            <img src="./home/imgs/f2-add-route.gif" style="height: 12rem; padding:1rem;">

            <h2>
                <div class="ar">الهدف</div>
                <div class="en">goal</div>
            </h2>
            <li>
                <div class="ar"> موقع و تطبيق لعرض خريطة مسارات النقل العام في العراق و تمكين
                    المستخدم من اضافة المزيد من المسارات اليها ما سيزيد حجم الخارطة
                    , لتسهيل التنقل
                    بتكاليف قليلة
                </div>
                <div class="en">webstie and application that shows the public transportation
                    map of iraq, and allows anyone to add a new route so to increase the size of
                    the map, to facilitate mobility in a lower costs</div>
            </li>

            <br>
            <h2>
                <div class="ar">كيفية الاستخدام و المميزات</div>
                <div class="en">how to use and features</div>
            </h2>

            <div>

                <li>
                    <img src="./home/imgs/route-icon.png" alt="">
                    <div class="ar">مسار الكية او الكوستر من البداية للنهاية</div>
                    <div class="en">public transportation line from start to end</div>
                </li>

                <br>

                <li>
                    <div class="ar">اظهار مسارات النقل العام: مكتملة و غير
                        مكتملة</div>
                    <div class="en">display public transportation routes;
                        completed and incompleted</div>
                    <img src="./home/imgs/f1-display-routes.jpg" alt="">
                    <img src="./home/imgs/f1-choose-display.png" alt="">
                </li>
                <li>
                    <div class="ar">اضافة مسار</div>
                    <div class="en">add route</div>
                    <img src="./home/imgs/f2-add-route-btn-p.png">
                    <!-- <img src="./home/imgs/f2-add-route-btn.png" alt=""> -->
                    <img src="./home/imgs/f2-add-route.png" alt="">
                </li>
                <li>
                    <div class="ar">التصويت على المسار, لزيادة دقتها</div>
                    <div class="en">vote for a route, to increase their accuracy</div>
                    <img src="./home/imgs/f3-route-click.png">
                    <img src="./home/imgs/f3-vote.png" alt="">
                </li>
                <li>
                    <div class="ar">تحديد مكان و الحصول على رابط الاشارة اليه</div>
                    <div class="en">select a location to get share link to it</div>
                    <!-- <img src="./home/imgs/general/red-pin-icon.png" alt=""> -->
                    <img src="./home/imgs/f4-share-loc-btn.png">
                    <img src="./home/imgs/f4-share-loc.png">

                </li>

            </div>


            <!-- sindibad -->
            <img src="./home/imgs/general/sindibad-goal.png" class="sindibadIcons">
        </div>


        <!-- leaderboard -->
        <div style="height: 100%; width: 100%; margin: auto; position: relative;">
            <img src="./home/imgs/sindibad-basic-icon.png" id="leaderBoardImg">

            <div class="leaderBoard" style="height: 90%; width: 90%;">


                <div class="rankingSections" style="margin-bottom: 1rem;">
                    <p style="color: white; display: inline;">leaderBoard</p>

                    <button id="displayUsersRanking" class="">users</button>
                    <button id="displayteamsRanking" class="">team</button>
                    <button href="#me" class="box">me</button>
                </div>

                <div class="rankingHeader">
                    <button id="rankingSorting" class="box">المركز</button>
                    <button id="accountHeader" class="box">الحساب</button>
                    <div class="points">
                        <button class="box" id="addedRoutesSorting"
                            style="background-image: url('./home/imgs/f2-add-route-btn-p.png');"></button>
                        <button class="box" id="votesSorting"
                            style="background-image: url('./home/imgs/f3-vote.png');"></button>
                        <button class="box" id="totalSorting">=</button>
                    </div>
                </div>
                <br>
                <div id="usersRanking">

                    <!-- prototyped account -->
                    <div class="rankedAccount">
                        <div class="ranking points">${index+1}</div>
                        <div class="account flex" style="justify-content: flex-start;">
                            <img class="accountImg" style="background-image: url('${account.img}');">
                            <h3 class="accountUsername ranked">${account.userName}</h3>
                        </div>

                        <div class="publiclinePoints points">${points}</div>
                        <div class="bygreenPoints points">${points}</div>
                        <div class="total points">${account.red.length+account.green.length}</div>
                    </div>
                </div>

                <div id="teamsRanking" style="display: none;">
                    <!-- prototyped account -->
                    <div class="rankedAccount">
                        <div class="ranking">${index+1}</div>
                        <div class="account flex" style="justify-content: flex-start;">
                            <img class="accountImg" style="background-image: url('${account.img}');">
                            <h3 class="accountUsername ranked">${account.userName}</h3>
                        </div>

                        <div class="publiclinePoints">${points}</div>
                        <div class="bygreenPoints">${points}</div>
                        <div class="total">${account.red.length+account.green.length}</div>
                    </div>
                </div>

            </div>

        </div>

        <div id="shordDescription" class="box">
            <h2 style="font-size: 2rem;">
                <h2 class="ar" style="font-size: 2rem;">
                    وصف الموقع
                </h2>
                <h2 class="en" style="font-size: 2rem;">website description</h2>
            </h2>

            <div class="ar">
                بسبب غياب النقل العام في العراق ظهرت حافلات رخيصة التكلفة على الناس
                تسير بمسارات ثابتة
                لكن لا يمكن الاعتماد على تلك الحافلات وحدها للوصول الى نقطة معينة و
                التنقل
                عموما بسبب عشوائيتها و عدم وجود خريطة توضح تلك المسارات في عموم البلد
                مشروع الخط العام يصنع تلك الخريطة بمساهمة الافراد في اضافة تلك
                الخارطة (مع اسمها) و التصويت على المسارات الموجود لزيادة دقة الخارطة
                مستقبلا (حيث يحذف المسار او يبقى حسب التصويت)

                ملاحظة: المسارات المضافة حديثا لا تضاف مباشرة الى الخارطة بل الى
                صفحة (ادمن) ليقوم بالتاكد من صحتها (منطقيا) عندها ستضاف الى الخارطة
                الرئيسية

                يمكن لاي احد زيارة صفحة الادمن و مشاهدة المسارات الحديثة لكن لا يمكن
                لاي احد (غير الادمن ) التعديل على المسارات فيها
            </div>
            <div class="en">
                Because of the absence of public transportation in Iraq, cheap buses appeared on the people
                It runs steady paths
                But you cannot rely on those buses alone to get to a certain point
                Mobility
                Generally because of its randomness and the lack of a map showing those paths throughout the country
                The Public Line Project makes that map with the contribution of individuals to add that
                Map (with its name) and vote on the existing tracks to increase the accuracy of the map
                In the future (where the track is deleted or remains according to the vote)

                Note: The newly added tracks are not added directly to the map, but to
                Page (admin) to make sure it is correct (logically) then it will be added to the map
                Main

                Anyone can visit the admin page and see the recent tracks, but it is not possible
                No one (other than the admin) can modify the tracks in it
            </div>
        </div>


        <div class="app box">
            <h2>
                <div class="ar">لتنزيل التطبيق</div>
                <div class="en">to download the app</div>
            </h2>
            <img src="./home/imgs/app-1.png" style="height: 18rem;">
            <img src="./home/imgs/app-2.png" style="height: 18rem;">
        </div>

        <div class="btns">
            <a href="https://kadum2.github.io/git4t/docs/publicline-doc" class="projectDoc box">
                <div class="ar">تفاصيل</div>
                <div class="en">more details</div>
            </a>
            <a href="https://github.com/kadum2/publicline" class="projectFiles
            box">
                <div class="ar">الكود</div>
                <div class="en">source code</div>
            </a>

            <button id="translateToEn" class="box">en</button>

        </div>

        <footer>

            <a href="https://kadum2.github.io/git4t" class="logo box">
                <div class="black"></div>
                <div class="red"></div>
                <div class="white"></div>
            </a>

            <div class="contact">
                <span class="red logoPart"></span>
                <h2>
                    <div class="ar">تواصل</div>
                    <div class="en">contact</div>
                </h2>
                <span>
                    <a href="https://www.instagram.com/kadum_0/" target="_blank">
                        <img src="./home/imgs/general/instagram-logo.png" alt="">
                    </a>
                    <a href="https://www.t.me/git4t_publicline" target="_blank">
                        <img src="./home/imgs/general/telegram-logo.png" alt="">
                    </a>
                    <a href="https://www.github.com/kadum2" target="_blank">
                        <img src="./home/imgs/general/github-logo.png" alt="">
                    </a>
                </span>

                <p style="line-height: 0;"> kadum.mo.jwad@gmail.com</p>
                <p style="line-height: 0;">makeitgreen002@gmail.com</p>

                <img src="./home/imgs/general/sindibad-contact.png" class="sindibadIcons">
            </div>
            <!-- 
            <div class="features" id="features">
                <div class="black logoPart"></div>

                <h2>الهدف</h2>
                <li>
                    موقع و تطبيق لعرض خريطة مسارات النقل العام في العراق و تمكين
                    المستخدم من اضافة المزيد من المسارات اليها, لتسهيل التنقل
                    بتكاليف قليلة
                </li>

                <br>
                <h2>كيفية الاستخدام و المميزات</h2>

                <div>
                    <li>اظهار مسارات النقل العام: مكتملة و غير مكتملة<img src="./home/imgs/f4-choose-display.png" alt="">
                    </li>
                    <li>اضافة مسار <img src="./home/imgs/add-route-icon.png"></li>
                    <li>التصويت على المسار, لزيادة دقتها <img src="./home/imgs/f2-vote.png"></li>
                    <li>تحديد موقع لنشره <img src="./home/imgs/general/red-pin-icon.png" alt=""></li>

                </div>


            </div>
            -->
            <div class="statics">
                <div class="green logoPart"></div>
                <h2>
                    <div class="ar">نتائج</div>
                    <div class="en">results</div>
                </h2>
                <div class="projectsInfo">

                    <div class="projectStatics" style="display: none;">
                        <b>git4t <img src="./home/imgs/general/git4t-logo.png" alt=""></b>
                        <li>
                            <div class="ar"> المستخدمين</div>
                            <div class="en">users</div>
                            : <img src="./home/imgs/general/account-icon.png" alt=""> <b id="accountsCounter">0</b>
                        </li>
                        <li>
                            <div class="ar"> المساهمات</div>
                            <div class="en">contributions</div>
                            : <img src="./home/imgs/general/account-icon.png" alt=""> <b id="contriCounter">0</b>
                        </li>
                    </div>

                    <div class="projectStatics">
                        <b>publicline <img src="./home/imgs/publicline-logo-green-blue.png" alt=""></b>
                        <li>
                            <span class="ar">المسارات المضافة</span>
                            <span class="en">added routes</span>
                            <img src="./home/imgs/add-route-icon.png">
                            <b id='routesCounter'>0</b>
                        </li>
                        <li>
                            <span class="ar">تم التصويت</span>
                            <span class="en">voted</span>
                            : <img src="./home/imgs/f2-vote.png" alt=""> <b id="votesCounter">0</b>
                        </li>

                    </div>

                    <br>
                    <div class="projectStatics" style="display: none;">
                        <b>bygreen <img src="https://kadum2.github.io/git4t/imgs/bygreen/bygreen-logo.png" alt=""></b>
                        <li>
                            <div class="ar">تم زراعتها</div>
                            <div class="en">planted</div>
                            <img src="https://kadum2.github.io/git4t/imgs/bygreen/green-pin-icon-stroked.png" alt=""><b
                                id="greenCounter">0</b>
                        </li>
                        <li>
                            <div class="ar">تحتاج الى زراعة</div>
                            <div class="en">need planting</div>
                            <img src="https://kadum2.github.io/git4t/imgs/bygreen/red-icon-stroked.png">
                            <b id="redCounter">0</b>
                        </li>
                        <li>
                            <div class="ar">الحملات الحالية</div>
                            <div class="en">current campaigns</div>
                            : <img src="https://kadum2.github.io/git4t/imgs/bygreen/yellow-icon-stroked.png"> <b
                                id="yellowCounter">0</b>
                        </li>
                        <li>
                            <div class="ar"> النباتات المزروعة</div>
                            <div class="en">palnted plants</div>
                            : <img src="https://kadum2.github.io/git4t/imgs/bygreen/plant-icon.png" alt=""> <b
                                id="contriCounter">0</b>
                        </li>
                        <li>عدد المشاتل: <img src="https://kadum2.github.io/git4t/imgs/bygreen/shop-icon.png" alt="">
                            <b id="shopsCounter">0</b></li>
                    </div>
                    <br>

                </div>

                <img src="./home/imgs/general/sindibad-results.png" class="sindibadIcons">
            </div>

            <a href="https://kadum2.github.io/injazat-3la-gd-el7al/">
                <img src="./home/imgs/general/injazat-logo.png" style="height: 3rem;">
            </a>

        </footer>

    </aside>

    <!-- service worker -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js');
            });
        }
    </script>

    <script type="module">


        // firebase 

import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";

import {getAuth, createUserWithEmailAndPassword, onAuthStateChanged, signOut, signInWithEmailAndPassword, signInWithPopup, GoogleAuthProvider} from "https://www.gstatic.com/firebasejs/9.9.2/firebase-auth.js"

import { getFirestore, onSnapshot,
	collection, doc, getDocs, getDoc,
	addDoc, deleteDoc, setDoc,
	query, where, orderBy, serverTimestamp,
	updateDoc, arrayUnion, arrayRemove, FieldValue } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-firestore.js";

// firebase storage; 
import {getStorage, ref, uploadBytes, getDownloadURL, listAll, list} from 'https://www.gstatic.com/firebasejs/9.9.2/firebase-storage.js'
    

const bygreenConfig = {
    apiKey: "AIzaSyDqK1z4fd7lO9g2ISbf-NNROMd7xpxcahc",
    authDomain: "bygreen-453c9.firebaseapp.com",
    projectId: "bygreen-453c9",
    storageBucket: "bygreen-453c9.appspot.com",
    messagingSenderId: "19954598250",
    appId: "1:19954598250:web:ba57c792bdf65dbc18a513",
    measurementId: "G-265TN8HGKX"
};

const bygreen = initializeApp(bygreenConfig, 'bygreen');
const bygreenDb = getFirestore(bygreen)
const bygreenAuth = getAuth(bygreen)
const bygreenStorage = getStorage(bygreen)

// let greenColor = '#27F060'
// let redColor = '#ff2a2a'
// green; #1EF738
// let blueColor = '#3388FF'

let lightGreen = '#27f060'
let greenColor = "#68F690"
let darkerGreenColor = '#21C24F'
let blueColor = '#198CD4'
let darkerBlueColor = '#075FDA'

// map configure
const map = L.map('map', { zoomControl: false }).setView([33.396600, 44.356579], 10); 
L.Control.geocoder().addTo(map);

// let apiKey = 'pk.eyJ1IjoiYWxmcmVkMjAxNiIsImEiOiJja2RoMHkyd2wwdnZjMnJ0MTJwbnVmeng5In0.E4QbAFjiWLY8k3AFhDtErA'

L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    maxZoom: 18,
    id: 'mapbox/streets-v11',
    tileSize: 512,
    zoomOffset: -1,
    accessToken: 'pk.eyJ1IjoiYWxmcmVkMjAxNiIsImEiOiJja2RoMHkyd2wwdnZjMnJ0MTJwbnVmeng5In0.E4QbAFjiWLY8k3AFhDtErA'
}).addTo(map);

        let bluePin = L.icon({
            iconUrl: "./home/imgs/blue-stroked-pin-icon.png",
            shadowSize: [50, 64], // size of the shadow
            shadowAnchor: [4, 62], // the same for the shadow
            // iconSize: [25, 41],
            // iconAnchor: [12, 41],
            iconAnchor: [12, 35],
            popupAnchor: [0, -30] 

        });
        let greenPin = L.icon({
            iconUrl: "./home/imgs/green-stroked-pin-icon.png",
            shadowSize: [50, 64], // size of the shadow
            shadowAnchor: [4, 62], // the same for the shadow
            // iconSize: [25, 41],
            // iconAnchor: [12, 41],
            iconAnchor: [12, 35],
            popupAnchor: [0, -30] 
        });
        let sindibad = L.icon({
            iconUrl: "./home/imgs/sindibad-basic-icon.png",
            shadowSize: [50, 64], // size of the shadow
            shadowAnchor: [4, 62], // the same for the shadow
            iconSize: [70, 60],
            iconAnchor: [26, 26],
            popupAnchor: [0, 0] 

        });


let dbUser ////firestore account 
let authUser ///auth account
// let type
let accountsList = []


////////////////////////////////////////////////getting-sending(auth)

const provider = new GoogleAuthProvider()
///////register 
document.querySelector('#registerBtn').addEventListener('click', (ev)=>{
    // check if valid data

    // send 
    if(ev.target.parentElement.querySelector(".em").value.length > 0 &&ev.target.parentElement.querySelector(".em").value.length < 20 && ev.target.parentElement.querySelector(".pw").value.length > 0){

        console.log('make account')
        document.querySelector('#greenMessage').style.display = 'block'
        createUserWithEmailAndPassword(bygreenAuth, ev.target.parentElement.querySelector(".em").value, ev.target.parentElement.querySelector(".pw").value).then(cred=>{
            console.log(cred)
            setTimeout(() => {
                document.querySelector('#greenMessage').style.display = 'none'
            }, 2000);
        }).catch(err=>{
            console.log(err.message)
            document.querySelector('#errors').textContent = err.message
            document.querySelector('#errors').style.display = 'block'
            setTimeout(() => {
                document.querySelector('#errors').style.display = 'none'
            }, 10000);
        })
    }else{

    }
    // empty 
    document.querySelector('#registerUsername').value = ''
    document.querySelector('#registerPassword').value = ''
})

//////signin
document.querySelector('#signinBtn').addEventListener('click', (ev)=>{
    console.log('to sign in')
    console.log(ev.target.parentElement)
    // console.log('click signin', document.querySelector('#signinUsername').value.length)
    // console.log(document.querySelector('#signinUsername').value.length >0)

    // send 
    if(document.querySelector('#signinUsername').value.length > 0 && document.querySelector('#signinPassword').value.length > 0){
        document.querySelector('#greenMessage').style.display = 'block'
        console.log('make account')
        signInWithEmailAndPassword(bygreenAuth, ev.target.parentElement.querySelector(".em").value ,ev.target.parentElement.querySelector(".pw").value).then(()=>{
            setTimeout(() => {
                document.querySelector('#greenMessage').style.display = 'none'
            }, 2000);
    
    
        })
    }else{

    }
    // empty 
    ev.target.parentElement.querySelector(".em").value = ''
    ev.target.parentElement.querySelector(".pw").value = ''
})

//////signout 
document.querySelector('#signoutBtn').addEventListener('click', ()=>{
    signOut(bygreenAuth, (result)=>{console.log(result); location.reload();})
})
document.querySelector('#halfLoggedSignoutBtn').addEventListener('click', ()=>{
    signOut(bygreenAuth, (result)=>{console.log(result); location.reload()})
})

// sign with google  
document.querySelector('#byGoogle').addEventListener('click', ()=>{
    signInWithPopup(bygreenAuth, provider).then((cred)=>console.log(cred))
})

//////make profile; 
document.querySelector('#makeProfileBtn').addEventListener('click', async (ev)=>{
    //////////set user in the users collection user current user uid 
    let q = query(collection(bygreenDb, 'users'), where('username', '==', ev.target.parentElement.querySelector('#username').value))
    let foundDoc = await getDocs(q)
    let found

    foundDoc.forEach(e=>{
        found = doc.data()
        console.log(doc.id, doc.data())
    })
    console.log(foundDoc, found)
    if(!found){
        console.log('no taken')

        let fileRef = ref(bygreenStorage, '/user-imgs/' + new Date().toISOString().replace(/:/g, '-') +document.querySelector("#userImg").files[0].name.replaceAll(" ","") )

            uploadBytes(fileRef, document.querySelector("#userImg").files[0]).then(res=>{
                getDownloadURL(res.ref).then(url=>{
                    console.log(url)
                    let imgUrl = url

        ///addDoc; add document to a collection; 
        setDoc(doc(bygreenDb, 'users', authUser.uid), {
            userName: ev.target.parentElement.querySelector('#username').value,
            name: ev.target.parentElement.querySelector('#name').value,
            bio: ev.target.parentElement.querySelector('#bio').value,
            img: imgUrl,
            red: [],
            green: [],
            yellow:[],
            addedRoutes: [], 
            votes: [],
            type: 'user'
        }).then(()=>{window.location.reload();}) 
        })
    })


    // setDoc(doc(bygreenDb, 'users', currentUser.uid), {name: ev.target.querySelector('username').value})
    
}else{
        //////////make messaga section to display errors 
        console.log('username already taken')
    }

})


///////////////////////////////////ui-js; 
document.querySelector("#miniProfileDi").addEventListener("click", (ev)=>{
    ev.target.classList.toggle('on')
    if(ev.target.classList.contains('on')){
        document.querySelector("#miniProfile").style.display = 'block'
    }else{
        document.querySelector("#miniProfile").style.display = 'none'
    }
})

document.querySelector('#asideDi').addEventListener('click', (ev)=>{
    ev.target.classList.toggle('red')
    ev.target.classList.contains('red')?document.querySelector('aside').style.display = 'flex':document.querySelector('aside').style.display = 'none'
})

document.querySelector('#makeLocLink').addEventListener('click', (ev)=>{ev.target.classList.toggle('on')})

document.querySelector("#addRouteMode").addEventListener("click", (ev)=>{
            ev.target.classList.toggle("on")
            if(ev.target.classList.contains('on')){
            // document.querySelector('#newRouteDetails').style.display='flex'
            ////delete all routes 
            map.removeLayer(hoveredRoute)
            routesObjects.forEach(route=>map.removeLayer(route))
            circlesObjects.forEach(circle=>map.removeLayer(circle))

            // routesObjects.forEach(ee=>{ee.setStyle({opacity:0, interactive: false})})
            // circlesObjects.forEach(ee=>{ee.setStyle({opacity:0, interactive: false})})

            }else{
                deployRoutes(routes)
                // addRouteMode.style.backgroundColor = '#54db7b'
                // document.querySelector('#newRouteDetails').style.display='none'
            }
})

let myLoc 
let myPin
let watchID
findMe.addEventListener('click', (ev)=>{
    ev.target.classList.toggle('on')
    if(ev.target.classList.contains('on')){
        // add marker and circle

        console.log("find me ...", navigator.geolocation)
        // internet based; 
        // no need to check and cant check 

        // get into the locatoin
        navigator.geolocation.getCurrentPosition(pos=>{
            map.flyTo([pos.coords.latitude, pos.coords.longitude], 12)
        })
    
        watchID = navigator.geolocation.watchPosition((pos)=>{
            console.log('watching; ',pos.coords.latitude, pos.coords.longitude)
            
            myPin?map.removeLayer(myPin):null
            myLoc?map.removeLayer(myLoc):null
    
            myPin = L.marker([pos.coords.latitude, pos.coords.longitude], {icon: sindibad}).addTo(map)
            myLoc = L.circle([pos.coords.latitude, pos.coords.longitude], {color: darkerBlueColor, radius: 100}).addTo(map)
            
            localStorage.setItem('clientLoc', [pos.coords.latitude, pos.coords.longitude])

            // map.flyTo([pos.coords.latitude, pos.coords.longitude], 16)
            // setView([pos.coords.latitude, pos.coords.longitude])

        }, (err)=>{
            console.log("gps not enabled")
            document.querySelector('#redMessage').textContent = 'enable gps'
            document.querySelector('#redMessage').style.display = 'block'

            setTimeout(() => {
                document.querySelector('#redMessage').style.display = 'none'
            }, 2000);
            // document.querySelector('#redMessage').textContent = 'enable gps'

            if(navigator.onLine){

                console.log('online')

                fetch('https://ipapi.co/json/')
                .then(res=>res.json())
                .then(data=>{
                    console.log('got online loc;', data)
                    map.flyTo([data.latitude, data.longitude], 12)
                    myPin = L.marker([data.latitude, data.longitude], {icon: sindibad}).addTo(map)
                    myLoc = L.circle([data.latitude, data.longitude], {color: darkerBlueColor, radius: 100}).addTo(map)

                    localStorage.setItem('clientLoc', [data.latitude, data.longitude])
        
                    console.log(myPin, myLoc)
                })

                document.querySelector('#redMessage').textContent = 'enable gps for more accurate results'
                document.querySelector('#redMessage').style.display = 'block'
                setTimeout(() => {
                    document.querySelector('#redMessage').style.display = 'none'
                }, 2000);

        // no permisson case
            }else{
                document.querySelector('#redMessage').textContent = 'no gps and no internet connection'
            document.querySelector('#redMessage').style.display = 'block'
            setTimeout(() => {
                document.querySelector('#redMessage').style.display = 'none'
                
            }, 3000);
    
        // give the previous saved location
        // if(myLat && myLon){
        //     console.log('geolocation is enabled')
        //     map.flyTo([myLat, myLon], 16)
        // }
            }

    })

    }else{
        // remove marker and circle, and stop watching 
        navigator.geolocation.clearWatch(watchID);
        map.removeLayer(myLoc)
        map.removeLayer(myPin)
    }
})

document.querySelector('#translateToEn').addEventListener('click', (ev)=>{
    ev.target.classList.toggle('on')
    if(ev.target.classList.contains('on')){
        document.querySelectorAll('.en').forEach((enElement)=>enElement.style.display='block')
        document.querySelectorAll('.ar').forEach((arELement)=>arELement.style.display='none')
        ev.target.textContent = 'ar'
    }else{
        document.querySelectorAll('.en').forEach((enElement)=>enElement.style.display='none')
        document.querySelectorAll('.ar').forEach((arELement)=>arELement.style.display='block')
        ev.target.textContent = 'en'
    }
})

//?
selectGovernate.addEventListener('change', (ev)=>{
    console.log('options', ev.target.value)

    // the most in numbers; main 
    if(ev.target.value=='baghdad'){
        console.log("this is baghdad")
        map.flyTo([33.396600, 44.356579], 10)
        localStorage.setItem('clientLoc', [33.396600, 44.356579])
    }else if(ev.target.value == 'basra'){
        map.flyTo([30.534238, 47.764500], 10)
        localStorage.setItem('clientLoc', [30.534238, 47.764500])
    }else if(ev.target.value == 'nineveh'){
        map.flyTo([36.346197, 43.158618], 10)
        localStorage.setItem('clientLoc', [36.346197, 43.158618])
    }else if(ev.target.value == 'sulaymaniyah'){
        map.flyTo([35.560957, 45.414252], 10)
        localStorage.setItem('clientLoc', [35.560957, 45.414252])
    }else if(ev.target.value == 'anbar'){
        map.flyTo([33.422346, 43.268823], 10)
        localStorage.setItem('clientLoc', [33.422346, 43.268823])
    }else if(ev.target.value == 'karbala'){
        map.flyTo([32.601386, 44.018819], 10)
        localStorage.setItem('clientLoc', [32.601386, 44.018819])
    }else if(ev.target.value == 'erbil'){
        map.flyTo([36.188488, 44.013199], 10)
        localStorage.setItem('clientLoc', [36.188488, 44.013199])
    }else if(ev.target.value == 'babil'){
        map.flyTo([32.471120, 44.426321], 10)
        localStorage.setItem('clientLoc', [32.471120, 44.426321])
    }else if(ev.target.value == 'najaf'){
        map.flyTo([32.001916, 44.331424], 10)
        localStorage.setItem('clientLoc', [32.001916, 44.331424])
    }else if(ev.target.value == 'dhi-qar'){
        map.flyTo([31.040835, 46.249916], 10)
        localStorage.setItem('clientLoc', [31.040835, 46.249916])
    }else if(ev.target.value == 'dohuk'){
        map.flyTo([36.862733, 42.991273], 10)
        localStorage.setItem('clientLoc', [36.862733, 42.991273])
    }else if(ev.target.value == 'kirkuk'){
        map.flyTo([35.470205, 44.390994], 10)
        localStorage.setItem('clientLoc', [35.470205, 44.390994])
    }else if(ev.target.value == 'saladin'){
        map.flyTo([34.596914, 43.676320], 10)
        localStorage.setItem('clientLoc', [34.596914, 43.676320])
    }else if(ev.target.value == 'diyala'){
        map.flyTo([33.741855, 44.613693], 10)
        localStorage.setItem('clientLoc', [33.741855, 44.613693])
    }else if(ev.target.value == 'wasit'){
        map.flyTo([32.516900, 45.816420], 10)
        localStorage.setItem('clientLoc', [32.516900, 45.816420])
    }else if(ev.target.value == 'maysan'){
        map.flyTo([31.838153, 47.144565], 10)
        localStorage.setItem('clientLoc', [31.838153, 47.144565])
    }else if(ev.target.value == 'al-qadisiyyah'){
        map.flyTo([31.987575, 44.917299], 10)
        localStorage.setItem('clientLoc', [31.987575, 44.917299])
    }else if(ev.target.value == 'muthanna'){
        map.flyTo([31.313330, 45.281570], 10)
        localStorage.setItem('clientLoc', [31.313330, 45.281570])
    }else if(ev.target.value == 'halabja'){
        map.flyTo([35.177346, 45.992220], 10)
        localStorage.setItem('clientLoc', [35.177346, 45.992220])
    }

    // ev.target.value == 'baghdad'?map.flyTo([33.314644, 44.420873], 10):null
})


/////////////////////////////////////////////ui-js-data

//map zoom
map.on('zoomend', function () {
    // let currentZoom = map.getZoom();
    console.log('current zoom;',map.getZoom()  , map.getBounds())
    routesObjects.forEach(route=>{
    if(map.getZoom() == 10){
        route.setStyle({weight: 5})
    }else if(map.getZoom() == 11){
        route.setStyle({weight: 10})
    }else if(map.getZoom() == 12){
        route.setStyle({weight: 15})
    }else if(map.getZoom() == 13){
        route.setStyle({weight: 20})
    }else if(map.getZoom() == 14){
        route.setStyle({weight: 25})
    }
    })
})

// ranking options
totalSorting.addEventListener('click', (ev)=>{
    ev.target.classList.toggle('on')
    ev.target.classList.contains('on')?ranking('total', 'ac'):ranking('total', 'de')
})
addedRoutesSorting.addEventListener('click', (ev)=>{
    ev.target.classList.toggle('on')
    ev.target.classList.contains('on')?ranking('addedRoutes', 'ac'):ranking('addedRoutes', 'de')
})
votesSorting.addEventListener('click', (ev)=>{
    ev.target.classList.toggle('on')
    ev.target.classList.contains('on')?ranking('votes', 'ac'):ranking('votes', 'de')
})
function ranking(based, order){

    // restructure the accounts array
//label the current account to be green 

let intendedOrder = []
let orderedUserElements
let orderedteamElements

if(based == 'total'){
    if(order == 'de'){
        // decending order 
        intendedOrder = accountsList.sort((a, b) => { return (b.green.length+b.red.length +b.addedRoutes.length + b.votes.length)-(a.green.length +a.red.length+a.addedRoutes.length + a.votes.length)}) 
    }else{
        //acending order 
        intendedOrder = accountsList.sort((a, b) => { return (a.green.length +a.red.length+a.addedRoutes.length + a.votes.length) - (b.green.length+b.red.length +b.addedRoutes.length + b.votes.length)})
    }
}else if(based == 'publicline'){
    if(order == 'de'){
        intendedOrder = accountsList.sort((a,b)=>{return (b.addedRoutes.length + b.votes.length) - (a.addedRoutes.length + a.votes.length)})
    }else{
        intendedOrder = accountsList.sort((a,b)=>{return (a.addedRoutes.length + a.votes.length)- (b.addedRoutes.length + b.votes.length)})
    }

}else if(based == 'bygreen'){
    if(order == 'de'){
        intendedOrder = accountsList.sort((a,b)=>{return (b.red.length + b.green.length) - (a.red.length + a.green.length)})
    }else{
        intendedOrder = accountsList.sort((a,b)=>{return (a.red.length + a.green.length)- (b.red.length + b.green.length)})
    }
}

// make the dom
let currentUserName 
dbUser?currentUserName=dbUser.userName:null

let userCounter= 1
orderedUserElements = `${intendedOrder.map((account, index)=>{
    if(account.type == 'user'){return`
<div class="rankedAccount" ${account.userName == currentUserName?'id="#me" style="background-color: #29D659"':''}>

    <div class="ranking point">${userCounter++}</div>
    <a href=' https://kadum2.github.io/ivc/profile/${account.userName}' class="account">
        <img class="accountImg" style="background-image: url('${account.img}');">
        <h3 class="accountUsername ranked">${account.userName}</h3>
    </a>
        

    <div class='points'>
<div class="publiclineCounter point">${(account.addedRoutes[0]?account.addedRoutes.length:0)+(account.votes[0]?account.votes.length:0)}</div>
<div class="bygreenCounter point">${(account.red[0]?account.red.length:0)+(account.green[0]?account.green.length:0)}</div>
<div class="total point">${((account.addedRoutes[0]?account.addedRoutes.length:0)+(account.votes[0]?account.votes.length:0)) + ((account.red[0]?account.red.length:0)+(account.green[0]?account.green.length:0))}</div>
</div>
    </div>
`}
})}`


    let teamCounter = 1
orderedteamElements = `${intendedOrder.map((account, index)=>{
    if(account.type == 'team'){return`
<div class="rankedAccount" ${account.userName == currentUserName?'style="background-color: #29D659"':''}>
    <div class="ranking point">${teamCounter++}</div>
    <a href=' https://kadum2.github.io/ivc/profile/${account.userName}' class="account">
        <img class="accountImg" style="background-image: url('${account.img}');">
        <h3 class="accountUsername ranked">${account.userName}</h3>
    </a>

    <div class='points'>
<div class="publiclineCounter point">${(account.addedRoutes[0]?account.addedRoutes.length:0)+(account.votes[0]?account.votes.length:0)}</div>
<div class="bygreenCounter point">${(account.red[0]?account.red.length:0)+(account.green[0]?account.green.length:0)}</div>
<div class="total point">${((account.addedRoutes[0]?account.addedRoutes.length:0)+(account.votes[0]?account.votes.length:0)) + ((account.red[0]?account.red.length:0)+(account.green[0]?account.green.length:0))}</div>
</div>
    </div>
`}
    })}`

// console.log('intended order',intendedOrder)
document.querySelector('#usersRanking').innerHTML = orderedUserElements.replaceAll(',', '')
document.querySelector('#teamsRanking').innerHTML = orderedteamElements.replaceAll(',', '')
}


// display routes buttons

displayCompletedRoutes.addEventListener('click', (ev)=>{
    console.log("display completed routes ")
    ev.target.classList.toggle('on2')
    if(ev.target.classList.contains('on2')){
        console.log(completedRoutes, completedRoutesObjects, circlesObjects)
        completedRoutesObjects.forEach(routeObj=>{

            circlesObjects.forEach(circleObj=>{
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    circleObj.addTo(map)
                }
            })

            routeObj.addTo(map)
        })

    }else{
        console.log(completedRoutes, completedRoutesObjects, circlesObjects)


        completedRoutesObjects.forEach(routeObj=>{
            circlesObjects.forEach(circleObj=>{
                console.log(circleObj._latlng, routeObj._latlngs[0], )
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    console.log('remove circle; ', circleObj)
                    map.removeLayer(circleObj)
                }
            })

            map.removeLayer(routeObj)
        })
            
    }
})

displayUncompletedRoutes.addEventListener('click', (ev)=>{
    console.log("display uncompleted routes ")
    ev.target.classList.toggle('on2')
    if(ev.target.classList.contains('on2')){
        console.log(uncompletedRoutes, uncompletedRoutesObjects, circlesObjects)
        uncompletedRoutesObjects.forEach(routeObj=>{

            circlesObjects.forEach(circleObj=>{
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    circleObj.addTo(map)
                }
            })

            routeObj.addTo(map)
        })

    }else{
        console.log(uncompletedRoutes, uncompletedRoutesObjects, circlesObjects)


        uncompletedRoutesObjects.forEach(routeObj=>{
            circlesObjects.forEach(circleObj=>{
                console.log(circleObj._latlng, routeObj._latlngs[0], )
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    console.log('remove circle; ', circleObj)
                    map.removeLayer(circleObj)
                }
            })

            map.removeLayer(routeObj)
        })
            
    }
})

displayConfirmedRoutes.addEventListener('click', (ev)=>{
    console.log("display confirmed routes ")
    ev.target.classList.toggle('on2')
    if(ev.target.classList.contains('on2')){
        console.log(confirmedRoutes, confirmedRoutesObjects, circlesObjects)
        confirmedRoutesObjects.forEach(routeObj=>{

            circlesObjects.forEach(circleObj=>{
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    circleObj.addTo(map)
                }
            })

            routeObj.addTo(map)
        })

    }else{
        console.log(confirmedRoutes, confirmedRoutesObjects, circlesObjects)


        confirmedRoutesObjects.forEach(routeObj=>{
            circlesObjects.forEach(circleObj=>{
                console.log(circleObj._latlng, routeObj._latlngs[0], )
                if(JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[0]) || JSON.stringify(circleObj._latlng) == JSON.stringify(routeObj._latlngs[routeObj._latlngs.length-1])){
                    console.log('remove circle; ', circleObj)
                    map.removeLayer(circleObj)
                }
            })

            map.removeLayer(routeObj)
        })
            
    }
})



///////////////////////////////////////getting  

        let tempMarker 

        let hoveredRoute 
        let hoveredstart
        let hoveredend
        let type

        let routes 
        let currentRouteId

        let completedRoutes
        let uncompletedRoutes
        let confirmedRoutes

        onAuthStateChanged(bygreenAuth, async (user)=>{

            document.querySelector('#greenMessage').style.display = 'block'

            // get into client stored location 
            localStorage.getItem('clientLoc')?map.flyTo([localStorage.getItem('clientLoc').split(',')[0], localStorage.getItem('clientLoc').split(',')[1]], 12):null

            // dynamic routes  
            if(window.location.href.includes('location')){
            console.log('contains temp pin', window.location.href.indexOf('location'), window.location.href.slice(0, window.location.href.indexOf('location')))

            // make the pin
            let currentPin = L.marker({
        lat: window.location.href.split('/')[window.location.href.split('/').length-2].split(',')[0],
        lng: window.location.href.split('/')[window.location.href.split('/').length-2].split(',')[1]
        }, {icon: greenPin}).addTo(map)

            // flyto it 
            console.log(currentPin)
            map.flyTo(currentPin._latlng, 16)

                }

            // if visiting the website for the first time will get into some instructions
            if (localStorage.getItem("firstVisit") === null) {
                // This is the user's first visit
                console.log("first time to visit the site; then to show instructions")
                document.querySelector('#redArrow').style.display = 'block'
                // document.querySelector('#asideDi').classList.toggle('red')
                // document.querySelector('#asideDi').classList.contains('red')?document.querySelector('aside').style.display = 'flex':document.querySelector('aside').style.display = 'none'

                setTimeout(() => {
                    // document.querySelector("#features").scrollIntoView({
                    //     behavior: "auto",
                    //     block: "center"
                    // })

                    // document.body.scrollIntoView({ behavior: 'smooth', block: 'end'
                    // });
                    
                    // window.scrollTo(0, document.body.scrollHeight);

                    document.querySelector('#redArrow').style.opacity = 0
                }, 3000)

                localStorage.setItem("firstVisit", false)
            } else {
                // This is not the user's first visit
            }
    
            // store visit 
            let visitor
            fetch('https://ipapi.co/json')
            .then(response => response.json())
            .then(async (data) => {
                visitor = data
                console.log('my ip', data);


            // check if the object with same ip does exist; if does add to visits counter, if not make new object with ip prop and visits prop 

            // method; check if exist

            // // const q = query(dbRef, orderByValue(), equalTo(testURL));
            // let q = query(collection(bygreenDb, 'visitors'), where('ip', '==', visitor.ip))
            // const snapshot = await getDocs(q);
            // let found
            // snapshot.forEach(e=>{found = e.data(); found.id = e.id})

            // console.log(found)


            // if (found) {
            // // add to it

            // console.log('data does exist; Results', found)
            // // let newVisits = found.visits+1
            //     updateDoc(doc(bygreenDb, "visitors", found.id), {visits: found.visits+1}).then(()=>console.log('updated the doc'))

            // } else {
            //     // make new one
            // console.log('Data does not exist')
            // addDoc(collection(bygreenDb, 'visitors'), {ip: visitor.ip, visits: 0}).then(()=>console.log('added the new visitor to the log'))
            // }


            ////// method; make docuement with ip to be the id by set method
            // setDoc(docRefr, {visits: 0}, {merge: true}).then(e=>{
            //     // document.querySelector('#greenMessage').textContent = 'sent'
            //     console.log('set new visitor', visitor.ip)
            //     // location.reload()
            // }).catch((err)=>{
            //     // cant be an error that set will always overwrite the current value
            //     // console.log(err)
            //     // add to this visitor counter
            //     // getdoc(docRefr).then(visitorDoc=>updateDoc(docRefr, {visits: visitorDoc.visits+1})) 
            // })

            let docRefr = doc(bygreenDb, 'visitors', visitor.ip)

            ////// method update first if error to set the document 
            getDoc(docRefr).then(visitorDoc=>{
                console.log(visitorDoc)
                visitorDoc = visitorDoc.data()
                console.log(visitorDoc)
                if(visitorDoc){
                    updateDoc(docRefr, {visits:+ visitorDoc.visits+1}).then(()=>{
                        console.log('exist and updated')
                    })
                }else{
                    console.log('not exist; then make it')
                    setDoc(docRefr, {visits: 1}, {merge: true})
                }
            }) 


            // updateDoc(docRefr, {visits: FieldValue.increment(1)})
            // .then(()=>{
            //     console.log("updated the document visitor")
            // }).catch(err=>{
            //     console.log('not exist to update; ')
            // })

            })


            if(user){
                console.log('from auth ', user)
                authUser = user
                user.getIdTokenResult().then(idTokenResult => {
                    console.log('claims', idTokenResult.claims)
                    type = idTokenResult.claims
                    // if team 
                    if (idTokenResult.claims.team){
                    document.querySelectorAll('.teamEle').forEach(teamEle=>teamEle.style.display = 'inline-block')
                    }
                })
        
                let dbUserDoc = await getDoc(doc(bygreenDb, 'users', user.uid))
                dbUser = dbUserDoc.data()
                
                if(dbUser){
                dbUser.id = dbUserDoc.id
        
                    ////registered
                    document.querySelectorAll('.logged').forEach(e=>{e.style.display = 'block'})
                    document.querySelectorAll('.halfLogged').forEach(e=>e.style.display = 'none')
                    document.querySelectorAll('.notLogged').forEach(e=>e.style.display = 'none')
        
                    // di
                    document.querySelector('#currentAccountImgDi').style.backgroundImage = `url('${dbUser.img}')`
                    document.querySelector("#currentAccountUsernameDi").textContent = '@'+ dbUser.userName
        
                    // mini
                    document.querySelector('#currentAccountImgMini').style.backgroundImage = `url('${dbUser.img}')`
                    document.querySelector("#currentAccountUsernameMini").textContent = '@'+ dbUser.userName
                    document.querySelector("#currentAccountName").textContent = dbUser.name
                    document.querySelector("#currentAccountBio").textContent = dbUser.bio
                    document.querySelector("#currentAccountLink").href = `https://kadum2.github.io/ivc/profile/${dbUser.userName}`
        
                }else{
                    /////half registered; make profile
                    document.querySelectorAll('.logged').forEach(e=>e.style.display = 'none')
                    document.querySelectorAll('.halfLogged').forEach(e=>e.style.display = 'block')
                    document.querySelectorAll('.notLogged').forEach(e=>e.style.display = 'none')
                }
                
            }else{
                /////not registered
                document.querySelectorAll('.logged').forEach(e=>e.style.display = 'none')
                document.querySelectorAll('.halfLogged').forEach(e=>e.style.display = 'none')
                document.querySelectorAll('.notlogged').forEach(e=>e.style.display = 'block')
                dbUser = 'none'
            }

            getDocs(collection(bygreenDb, 'users')).then((data)=>{

                setTimeout(() => {
                    document.querySelector('#greenMessage').style.display = 'none'
                }, 1000);

                let docs = []
                    data.docs.forEach(doc=>{
                        docs.push({...doc.data(), id: doc.id})
                    })
                    accountsList = docs
                    console.log(docs)
                    document.querySelector('#accountsCounter').textContent = accountsList.length
                    if(accountsList){
                        // console.log(accountsList, dbUser)
                        ranking('total', 'de')
                    }
            })

            getDocs(collection(bygreenDb, 'newroutes')).then((data)=>{
                let docs = []
                    data.docs.forEach(doc=>{
                        docs.push({...doc.data(), id: doc.id})
                    })
                    routes = docs
    
                    navigator.onLine?localStorage.setItem('routes', JSON.stringify(routes)):routes = JSON.parse(localStorage.getItem("routes") || "[]")
    
                    console.log(docs)
    
                    document.querySelector('#routesCounter').textContent = docs.length
                    let votes = 0
                    docs.forEach(route=> votes += (route.upvotes.length + route.downvotes.length))
                    // document.querySelector('#votesCounter').textContent = docs.filter
                    document.querySelector('#votesCounter').innerHTML = votes
    
                    document.querySelector('#greenMessage').style.display = 'none'

                    completedRoutes = routes.filter(route=> route.start && route.end && !route.confirmed)
                    uncompletedRoutes = routes.filter(route=>!route.start || !route.end && !route.confirmed)
                    confirmedRoutes = routes.filter(route=>route.confirmed)
                
                    routes.forEach(route=>console.log(!route.confirmed))
        
                deployRoutes(completedRoutes)
                displayCompletedRoutes.classList.toggle('on2')
                deployRoutes(uncompletedRoutes)
                displayUncompletedRoutes.classList.toggle('on2')

                deployRoutes(confirmedRoutes)
                displayConfirmedRoutes.classList.toggle('on2')
                    
                // console.log(confirmedRoutes)
                // console.log('completed routes',completedRoutes)
            })

            // data statics 
            getDocs(collection(bygreenDb, 'pins')).then((data)=>{
                let docs = []
                    data.docs.forEach(doc=>{
                        docs.push({...doc.data(), id: doc.id})
                    })

                    let red = 0
                    let green = 0
                    let yellow = 0
                    let redToGreen = 0

                    docs.forEach(generalPin=>{
                        generalPin.afterImgs?red++:green++
                        generalPin.next?yellow++:null
                        generalPin.redToGreen?redToGreen++:null
                    })

                    document.querySelector('#redCounter').textContent = red
                    document.querySelector('#greenCounter').textContent = green
                    document.querySelector('#yellowCounter').textContent = yellow
                    // document.querySelector('#redToGreenCounter').textContent = green
            })

            getDocs(collection(bygreenDb, 'shop')).then((data)=>{
            let docs = []
                data.docs.forEach(doc=>{
                    docs.push({...doc.data(), id: doc.id})
                })
                // console.log(docs[0].upvotes.length + docs[0].downvotes)
                document.querySelector('#shopsCounter').textContent = docs.length
            })
        })

        function deployRoutes(ev){
            Object.values(ev).forEach(async e => { 
    
                /////content 
                let voteBtns = document.createElement('div')
                let routeName = document.createElement('h3')
                routeName.style.display= 'inline'
                let nameDiv = document.createElement('div')
                e.name?routeName.textContent = e.name:routeName.textContent = 'اسم المسار' 
                let checkImg = document.createElement('img')
                checkImg.setAttribute('src', './home/imgs/general/check-icon.png')
                checkImg.style.height = '1rem'
    
                // upvote btn
                let upvoteBtn = document.createElement("button")
                upvoteBtn.textContent = 'صحيح'
                upvoteBtn.classList.add("upvoteBtn")
                
                upvoteBtn.addEventListener('click', (ev)=>{
                    downvoteBtn.classList.contains('voted')?downvoteBtn.classList.remove('voted'):null
                    ev.target.classList.toggle('voted')
                    if(ev.target.classList.contains('voted')){
                        sureBtn.removeAttribute('disabled')
                    }else{
                        sureBtn.setAttribute('disabled', true)
                    }
    
                })
    
                // downvote btn
                let downvoteBtn = document.createElement("button")
                downvoteBtn.textContent = 'خاطئ'
                downvoteBtn.classList.add("downvoteBtn")
                // if(currentUser){
                //     e.downvotes.includes(currentUser)?downvoteBtn.style.border = "2px solid blue":null
                // }
    
                downvoteBtn.addEventListener('click', (ev)=>{
                    upvoteBtn.classList.contains('voted')?upvoteBtn.classList.remove('voted'):null
                    ev.target.classList.toggle('voted')
                    if(ev.target.classList.contains('voted')){
                        sureBtn.removeAttribute('disabled')
                    }else{
                        sureBtn.setAttribute('disabled', true)
                    }
                })
    
                let sureDiv = document.createElement('div')
                let sureBtn = document.createElement('button')
                sureBtn.textContent = 'متأكد'
                sureBtn.classList.add('sureBtn')
                sureBtn.setAttribute('disabled', true)
                sureBtn.addEventListener('click', (ev)=>{
    
                    console.log(ev.target,ev.target.parentElement.parentElement,currentRouteId)
    
                    // check what button choosed 
                    if(ev.target.parentElement.parentElement.querySelector('.upvoteBtn').classList.contains('voted')){
                        updateDoc(doc(bygreenDb, 'routes', currentRouteId), {upvotes: arrayUnion(dbUser.userName)}).then(()=>{
                            console.log('voted')
                            updateDoc(doc(bygreenDb, 'users', dbUser.id), {votes: arrayUnion(currentRouteId)})
                            console.log('record the vote')
                        })
                    }else if(ev.target.parentElement.parentElement.querySelector('.downvoteBtn').classList.contains('voted')){
                        updateDoc(doc(bygreenDb, 'routes', currentRouteId), {downvotes: arrayUnion(dbUser.userName)}).then(()=>console.log('voted'))
                    }
    
                    upvoteBtn.setAttribute('disabled', true)
                    downvoteBtn.setAttribute('disabled', true)
                    ev.target.setAttribute('disabled', true)
                })
                sureDiv.append(sureBtn)
    
                nameDiv.append(routeName)
                confirmedRoutes.includes(e)?nameDiv.append(checkImg):null
    
                /////insert
                voteBtns.append(nameDiv, upvoteBtn, downvoteBtn, sureDiv)
                    let routeObject = L.polyline(e.path, {color: confirmedRoutes.includes(e)?lightGreen:greenColor}).bindPopup(voteBtns).addTo(map)
    
                    // routeObject.name = e.name
                    e.start?circlesObjects.push(L.circle(e.path[0],{radius: 300, color: darkerGreenColor, background: darkerGreenColor}).addTo(map)):null
                    e.end?circlesObjects.push(L.circle(e.path[e.path.length-1],{radius: 300, color:darkerGreenColor, background:darkerGreenColor}).addTo(map)):null 
                    
                    routeObject.upvotes = e.upvotes
                    routeObject.downvotes = e.downvotes
                    routeObject.id = e.id
                    routeObject.start = e.start
                    routeObject.end = e.end
                    routeObject.confirmed = e.confirmed?true:false
                    
                /////content
                    ////////////if logged then allow to vote; 
                    routeObject.addEventListener('click', (ev)=>{
                        console.log('click on route', ev.target)
    
                        currentRouteId = e.id
    
                        ////////mobile; change color 
                        routesObjects.forEach(e=>{e.setStyle({color: greenColor, opacity: .6})})
                        hoveredRoute?map.removeLayer(hoveredRoute):null
                        hoveredRoute = L.polyline(ev.target._latlngs, {color: blueColor, interactive: false})
                        hoveredRoute.addTo(map)
                        hoveredRoute.setStyle({color:blueColor, opacity: 1})
    
    
                        if(dbUser != 'none'){
                            console.log(dbUser)
                            if(ev.target.upvotes || ev.target.downvotes){ ///temp
                                console.log('available votes options')
                                if(ev.target.upvotes.includes(dbUser.userName)){
                                    console.log('upvoter; ', ev.target.upvotes, ev.target.upvotes.includes(dbUser.userName))
                                    ev.target._popup._content.querySelector('.upvoteBtn').style.border = "2px solid blue"
    
                                    ev.target._popup._content.querySelector('.upvoteBtn').setAttribute('disabled', true)
                                    ev.target._popup._content.querySelector('.downvoteBtn').setAttribute('disabled', true)
                                    // downvoteBtn.setAttribute('disabled', true)
        
                                }else if(ev.target.downvotes.includes(dbUser.userName)){
                                    console.log('downvoter; ',ev.target.downvotes, ev.target.downvotes.includes(dbUser.userName))
                                    ev.target._popup._content.querySelector('.downvoteBtn').style.border = "2px solid blue"
    
                                    ev.target._popup._content.querySelector('.downvoteBtn').setAttribute('disabled', true)
                                    ev.target._popup._content.querySelector('.upvoteBtn').setAttribute('disabled', true)
                                }
                            }else{
                                console.log('no upvotes option')
                            }
    
                        }else{
                            // no account
                                // display; have to login to vote 
    
                            ev.target._popup._content.querySelector('.upvoteBtn').setAttribute('disabled', true)
                                    ev.target._popup._content.querySelector('.downvoteBtn').setAttribute('disabled', true)
                                    // ev.target._popup._content.append('انشئ حساب للتصويت')
                        }
    
                        e.upvotes?console.log('upvotes', e.upvotes):null
                        e.downvotes?console.log('downvotes', e.downvotes):null
                    })
    
                    routeObject._popup._content.append('انشئ حساب للتصويت')
    
                routesObjects.push(routeObject)
    
                routeObject.addEventListener("mouseover", (route)=>{
    
                    /// method 1; make route to display over all then to delete
                    /// it or replace it and to set it interactive false to
                    /// click over it 
    
                        // console.log(route.target)
                        routesObjects.forEach(e=>{e.setStyle({color: (e.confirmed?lightGreen:greenColor), opacity: .6})})
    
                        hoveredRoute?map.removeLayer(hoveredRoute):null
                        hoveredstart?map.removeLayer(hoveredstart):null
                        hoveredend?map.removeLayer(hoveredend):null
    
    
                        hoveredRoute = L.polyline(route.target._latlngs, {color:blueColor, opacity: 1,interactive: false}).addTo(map)
                        // console.log(route.target)
                        route.target.start?hoveredstart = L.circle(route.target._latlngs[0],{radius:300 ,color:blueColor, opacity: 1,interactive: false}).addTo(map):null
    
                        route.target.end?hoveredend = L.circle(route.target._latlngs[route.target._latlngs.length-1], {radius:300, color:blueColor, opacity: 1,interactive: false}).addTo(map):null
                })
    
                if(e.confirmed){
                    confirmedRoutesObjects.push(routeObject)
                }else if(e.start && e.end){
                    completedRoutesObjects.push(routeObject)
                }else if(!e.start || !e.end){
                    uncompletedRoutesObjects.push(routeObject)
                }
            })
        }



///////////////////////////////////////////sending data

        //////////collect (get) data 

        /////containers; 
        let completedRoutesObjects = []
        let uncompletedRoutesObjects = []
        let confirmedRoutesObjects = []

        let circlesObjects = []

        let routesObjects = [] ///to hover and change color; check more about
        let markers = [] /// list of the labels object
        //path 
        let path = [] ///path points
        let currentPath = [] //path object

        //circles
        let start 
        let end 

        // make the main route
        map.addEventListener('click', function (ev) {
            if(document.querySelector("#addRouteMode").classList.contains("on")){
                /////////disable all routes 
                // routesObjects.forEach(ee=>{ee.setStyle({opacity:0, interactive: false})})
                // circlesObjects.forEach(ee=>{ee.setStyle({opacity:0, interactive: false})})
                console.log('routes; ',routesObjects)
                console.log('circles; ', circlesObjects)

                ////get data 
                let latlng = map.mouseEventToLatLng(ev.originalEvent);
                console.log(latlng)

                ////make 
                let m = L.marker(latlng, {
                    icon: bluePin
                }).addTo(map);
                markers.push(m) 


                ////content; no need; current label ??

                /////insert 
                ////js 
                path.push(latlng)
                ////ui 
                currentPath != 0 ? map.removeLayer(currentPath) : null
                currentPath = L.polyline(path).setStyle({color: darkerGreenColor}).addTo(map)
            }else{

                if(document.querySelector('#makeLocLink').classList.contains("on")){

                // add direct pin and link to share
                tempMarker?map.removeLayer(tempMarker):null

                if(window.location.href.includes('location')){
                    // tempMarker = L.marker(map.mouseEventToLatLng(ev.originalEvent), {icon: greenPin}).bindPopup(`link; <br><a href='${window.location.href.slice(0, window.location.href.indexOf('location'))+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng}/'>${window.location.href.slice(0, window.location.href.indexOf('location'))+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng}/</a>`).addTo(map)
                    
                    let makeLocDiv = document.createElement('div')

                    let linkElement = document.createElement('a')
                    linkElement.setAttribute('href', window.location.href.slice(0, window.location.href.indexOf('location'))+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng)
                    linkElement.textContent = '...link'

                    let copyBtn = document.createElement('button')
                    copyBtn.classList.add('box')
                    copyBtn.textContent = 'copy'

            let textToCopy = window.location.href.slice(0, window.location.href.indexOf('location'))+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng+'/'

            copyBtn.addEventListener("click", ()=>{
                navigator.clipboard.writeText(textToCopy).then(function() {
                document.querySelector('#copyMessage').style.display = 'block'

                setTimeout(() => {
                    document.querySelector('#copyMessage').style.display = 'none'
                    
                }, 2000);
                }, function(err) {
                console.error("Failed to copy text: ", err);
                });
            });

                    makeLocDiv.append(copyBtn, linkElement)

                    tempMarker = L.marker(map.mouseEventToLatLng(ev.originalEvent), {icon: greenPin}).bindPopup(makeLocDiv).addTo(map)


                }else{

                        // github 
                                if(window.location.href.includes('github')){

                                    // tempMarker = L.marker(map.mouseEventToLatLng(ev.originalEvent), {icon: greenPin}).bindPopup(`link; for github <br><a href='https://kadum2.github.io/publicline${'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng}/'>${'https://kadum2.github.io/publicline/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng}/</a> <br> something`).addTo(map)

                                    // https://kadum2.github.io/publicline

                                    
                                    let makeLocDiv = document.createElement('div')

                                    let linkElement = document.createElement('a')
                                    linkElement.setAttribute('href', 'https://kadum2.github.io/publicline'+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng)
                                    linkElement.textContent = '...link'

                                    let copyBtn = document.createElement('button')
                                    copyBtn.classList.add('box')
                                    copyBtn.textContent = 'copy'

                            let textToCopy = 'https://kadum2.github.io/publicline'+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng+'/'

                            copyBtn.addEventListener("click", ()=>{
                                console.log("clicked on copy")
                                navigator.clipboard.writeText(textToCopy).then(function() {
                                document.querySelector('#copyMessage').style.display = 'block'

                                setTimeout(() => {
                                    document.querySelector('#copyMessage').style.display = 'none'
                                    
                                }, 2000);
                                }, function(err) {
                                console.error("Failed to copy text: ", err);
                                });
                            });

                            makeLocDiv.append(copyBtn, linkElement)

                            tempMarker = L.marker(map.mouseEventToLatLng(ev.originalEvent), {icon: greenPin}).bindPopup(makeLocDiv).addTo(map)

                                }else{

                                    let makeLocDiv = document.createElement('div')

                                    let linkElement = document.createElement('a')
                                    linkElement.setAttribute('href', window.location.hostname+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng)
                                    linkElement.textContent = '...link'

                                    let copyBtn = document.createElement('button')
                                    copyBtn.classList.add('box')
                                    copyBtn.textContent = 'copy'

                            let textToCopy = window.location.hostname+'/location/'+map.mouseEventToLatLng(ev.originalEvent).lat+','+map.mouseEventToLatLng(ev.originalEvent).lng+'/'

                            copyBtn.addEventListener("click", ()=>{
                                navigator.clipboard.writeText(textToCopy).then(function() {
                                document.querySelector('#copyMessage').style.display = 'block'

                                setTimeout(() => {
                                    document.querySelector('#copyMessage').style.display = 'none'
                                    
                                }, 2000);
                                }, function(err) {
                                console.error("Failed to copy text: ", err);
                                });
                            });

                                    makeLocDiv.append(copyBtn, linkElement)

                                    tempMarker = L.marker(map.mouseEventToLatLng(ev.originalEvent), {icon: greenPin}).bindPopup(makeLocDiv).addTo(map)

                            }
                
        }
            }else{
            tempMarker?map.removeLayer(tempMarker):null
            }
            }
        });

        /////adding points
        document.querySelector("#start").addEventListener('click', (e)=>{
            e.target.classList.toggle("on")
            if(e.target.classList.contains('on')){
                // get current making route; 
                console.log(currentPath._latlngs[0])
                start = L.circle(currentPath._latlngs[0], {radius: 600, color: darkerGreenColor}).addTo(map)
                // e.target.style.background = '#ff2a2a'
            }else{
                // start.removeLayer(map)/
                map.removeLayer(start)
                // e.target.style.background = '#1bf057'
            }
        })

        document.querySelector("#end").addEventListener('click', (e)=>{
            e.target.classList.toggle("on")
            if(e.target.classList.contains('on')){
                // get current making route; 
                console.log(currentPath._latlngs[currentPath._latlngs.length - 1])
                end = L.circle(currentPath._latlngs[currentPath._latlngs.length - 1], {radius: 600, color: darkerGreenColor}).addTo(map)
                // e.target.style.background = '#ff2a2a'
            }else{
                // start.removeLayer(map)/
                map.removeLayer(end)
                // e.target.style.background = '#1bf057'
            }

        })

        ////cencel step
        
        document.querySelector("#cancel-step").addEventListener("click", () => {
            //ui 

            map.removeLayer(markers[markers.length - 1])

            //data 
            markers.pop()

            path.pop()
            // points.pop()
            map.removeLayer(currentPath)
            currentPath = L.polyline(path, {color: 'red'}).addTo(map)
        })

    ////////////////////////sending 

        document.querySelector("#send").addEventListener("click", () => {

            // if logged send the username with it; 
            // check if data; may make it only available when data set; 
            // make object; 
            let routeToSend = {}
            if(currentPath[0] || document.querySelector('#routeName').value){ /////available data to send; 
                // routeToSend.path = currentPath._latlngs 
                // document.querySelector('#greenMessage').textContent = 'sending'
                document.querySelector('#greenMessage').style.display = 'block'
                
                console.log(currentPath)
                let validRoute = []
                // let notvalidRoute = []
                // currentPath._latlngs.forEach(e=>validRoute.push(e))
                Object.values(currentPath._latlngs).forEach(e=>validRoute.push({lng: e.lng,lat: e.lat}))
                routeToSend.path = validRoute
                routeToSend.name = document.querySelector("#routeName").value
                start?routeToSend.start = true:routeToSend.start = false
                end?routeToSend.end = true:routeToSend.end = false
                routeToSend.upvotes = []
                routeToSend.downvotes = []

                console.log(routeToSend, typeof routeToSend.route, typeof notvalidRoute)

                //////send; 
                addDoc(collection(bygreenDb, 'unroutes'), routeToSend).then(e=>{
                    // document.querySelector('#greenMessage').textContent = 'sent'
                    location.reload()

                    setTimeout(() => {
                        document.querySelector('#greenMessage').style.display = 'none'
                    }, 1000);

                })
            }else{
                console.log('set the rest data')
                document.querySelector("#redMessage").textContent = 'اكمل ملئ البيانات و اضافة مسار كامل'
                document.querySelector("#redMessage").style.display='block'

                setTimeout(() => {
                    document.querySelector("#redMessage").textContent = ''
                    document.querySelector("#redMessage").style.display='none'
                }, 2000);
            }
    })

    </script>

</body>

</html>

<!-- https://kadum2.github.io/publicline/home/imgs/ -->
<!-- ./home/imgs/ -->